<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Banerjee Stores - Products</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <style>
    body { visibility: hidden; }
  </style>
</head>
<body>

  <!-- ðŸ”— Header -->
  <div id="header-container"></div>

  <!-- ðŸ§­ Category Bar -->
  <div class="category-bar" id="categoryBar">
    <!-- Category buttons will be inserted here -->
  </div>

  <!-- ðŸ›ï¸ Product Grid -->
  <section class="products-section" id="productList">
    <!-- Product cards will be injected here -->
  </section>

  <!-- ðŸ”Œ Firebase Config -->
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="script.js"></script>

  <!-- ðŸš€ Product Logic -->
  <script type="module">
    import { db } from "./firebase-config.js";
    import {
      collection,
      getDocs,
      query
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const productList = document.getElementById("productList");
    const categoryBar = document.getElementById("categoryBar");

    let allProducts = [];

    // Load Products from Firebase
    async function fetchProducts() {
      const q = query(collection(db, "products"));
      const snapshot = await getDocs(q);
      allProducts = [];
      const categorySet = new Set();

      snapshot.forEach((doc) => {
        const product = doc.data();
        allProducts.push(product);
        categorySet.add(product.category);
      });

      renderCategories([...categorySet]);
      renderProducts(allProducts); // Show all products initially
    }

    // Render Category Buttons
    function renderCategories(categories) {
      categoryBar.innerHTML = "";

      const allBtn = document.createElement("button");
      allBtn.textContent = "All";
      allBtn.addEventListener("click", () => renderProducts(allProducts));
      categoryBar.appendChild(allBtn);

      categories.forEach((cat) => {
        const btn = document.createElement("button");
        btn.textContent = cat;
        btn.addEventListener("click", () => {
          const filtered = allProducts.filter(p => p.category === cat);
          renderProducts(filtered);
        });
        categoryBar.appendChild(btn);
      });
    }

    // Render Product Cards
    function renderProducts(products) {
      productList.innerHTML = "";

      if (products.length === 0) {
        productList.innerHTML = "<p>No products found in this category.</p>";
        return;
      }

      products.forEach(product => {
        const card = document.createElement("div");
        card.className = "product-card";
        card.innerHTML = `
          <div class="product-img">
            <img src="${product.imageURL}" alt="${product.name}" />
          </div>
          <div class="product-info">
            <h3>${product.name}</h3>
            <p>Unit: ${product.unit}</p>
            <p>Price: â‚¹${product.price}</p>
            <button>Add to Cart</button>
          </div>
        `;
        productList.appendChild(card);
      });
    }

    fetchProducts();
  </script>

</body>
</html>
