<!-- ðŸ“˜ Facebook-Style index.html for Banerjee Stores -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Banerjee Stores</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>

  <!-- ðŸ”— Injected Header -->
  <div id="header-container"></div>

  <!-- ðŸ§­ Category Filter -->
  <div class="category-bar" id="categoryBar">
    <!-- Buttons will be inserted here -->
  </div>

  <!-- ðŸ›’ Product Cards -->
  <section class="products-section" id="productList">
    <!-- Product cards will be injected -->
  </section>

  <!-- ðŸ”Œ Firebase Config -->
  <script type="module" src="firebase-config.js"></script>

  <!-- ðŸ“œ Script for dynamic content -->
  <script type="module">
    import { db } from "./firebase-config.js";
    import { collection, getDocs, query } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    fetch("header.html")
      .then(res => res.text())
      .then(data => {
        document.getElementById("header-container").innerHTML = data;
      });

    const productList = document.getElementById("productList");
    const categoryBar = document.getElementById("categoryBar");
    let allProducts = [];

    async function fetchProducts() {
      const q = query(collection(db, "products"));
      const snapshot = await getDocs(q);

      allProducts = [];
      let categorySet = new Set();

      snapshot.forEach((doc) => {
        const data = doc.data();
        allProducts.push(data);
        categorySet.add(data.category);
      });

      renderCategories([...categorySet]);
      renderProducts(allProducts);
    }

    function renderProducts(products) {
      productList.innerHTML = "";
      if (products.length === 0) {
        productList.innerHTML = "<p>No products found.</p>";
        return;
      }

      products.forEach((product) => {
        const card = document.createElement("div");
        card.className = "product-card";
        card.innerHTML = `
          <img src="${product.imageURL}" alt="${product.name}" />
          <div class="card-body">
            <h3>${product.name}</h3>
            <p>${product.unit}</p>
            <p>â‚¹${product.price}</p>
            <button>Add to Cart</button>
          </div>
        `;
        productList.appendChild(card);
      });
    }

    function renderCategories(categories) {
      categoryBar.innerHTML = "";

      const allBtn = document.createElement("button");
      allBtn.textContent = "All";
      allBtn.addEventListener("click", () => renderProducts(allProducts));
      categoryBar.appendChild(allBtn);

      categories.forEach((cat) => {
        const btn = document.createElement("button");
        btn.textContent = cat;
        btn.addEventListener("click", () => {
          const filtered = allProducts.filter(p => p.category === cat);
          renderProducts(filtered);
        });
        categoryBar.appendChild(btn);
      });
    }

    fetchProducts();
  </script>

</body>
</html>
